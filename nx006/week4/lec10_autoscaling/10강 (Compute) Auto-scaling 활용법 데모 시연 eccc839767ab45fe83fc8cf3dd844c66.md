# 10강.(Compute) Auto-scaling 활용법 데모 시연

강의시간: 12:11

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled.png)

Launch Configuration은, Auto Scaling 적용 시 먼저 설정해야 할 세팅입니다.

Auto Scaling이 수행될 때, 어떤 서버를 늘릴 것인지를 미리 설정합니다.

여기서는 Standard g2 서버를 사용합니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%201.png)

생성되는 서버 이름에 Prefix를 줄 수 있습니다(여기서는 생략).

최소 용량은, Auto Scaling에 의해서 제어되는 서버의 최소 개수입니다.

최소 용량은, Auto Scaling에 의해서 제어되는 서버의 최대 개수입니다.

기대 용량은, Auto Scaling이 시작될 때의 기본 서버 개수입니다.

Auto Scaling이 시작되고 나면, 기대 용량에서 시작되어, 점차 서버를 최소 용량에서 최대 용량 사이에서 늘였다 줄였다 합니다.

쿨다운은 서버가 만들어지고 나서, 서버가 초기 여러가지 동작(데몬을 올리고 세팅하는 등)을 하게 될텐데, 이를 기다리는 시간입니다. NCP에서는 서버가 만들어지자 마자 서버가 정상 작동한다고 판단할텐데, 실제로 서버 세팅이 완료되기까지 기다리기 위해서는 쿨다운을 설정해야 합니다.

헬스 체크 역시 80 포트가 응답한다고 그 즉시 서버를 바인딩하면, 소스가 다 내려오지 않아 문제가 생길 수 있습니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%202.png)

ACG를 설정합니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%203.png)

정책 설정과 일정 설정을 정할 수 있습니다.

- 일정 설정은 기간에 맞추어서 서버 수를 늘였다 줄였다 할 수 있습니다. 예를 들어서 금요일 날 이벤트를 해서 트래픽이 몰린다고 한다면, 금요일마다 서버를 일시적으로 늘렸다가 금요일이 끝나면 서버를 줄일 수 있습니다.
- 정책 설정은 언제 트래픽이 늘어날 지 모르지만, 조건에 맞추어서 비용을 최적화하는 방법입니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%204.png)

Auto Scaling Group을 만들었습니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%205.png)

Auto Scaling에 의해서 생성된 서버가 존재합니다.

이제 언제 서버를 늘리고 줄일 지, 그 기준을 정해야 합니다. 이는 Cloud Insight→Configuration→Event Rule 탭에서 확인할 수 있습니다. 해당 탭에서 Event Rule 생성을 누릅니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%206.png)

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%207.png)

Auto Scaling Group(VPC)을 눌러서 설정합니다. 이때 주의해야 할 것은, Auto Scaling Group 버튼이 안 나올 수도 있습니다. 이는 Auto Scaling이 설정 중이라서 안 나오는 것으로, 약 2~3분 정도 설정이 완료되길 기다린다면 Event Rule을 설정할 수 있는 버튼이 나오게 됩니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%208.png)

그룹 생성 버튼을 통해서 어떤 그룹을 설정할 것인지 대상을 정해줍니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%209.png)

그리고 템플릿을 설정해야 하는데, 평균 CPU 사용률(avg_cpu_used_rto)로 기준을 잡아주겠습니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%2010.png)

CPU 평균 사용률이 70%를 1분 이상 초과할 때, 서버를 늘리라고 임계조건을 설정합니다.

![Untitled](10%E1%84%80%E1%85%A1%E1%86%BC%20(Compute)%20Auto-scaling%20%E1%84%92%E1%85%AA%E1%86%AF%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%87%E1%85%A5%E1%86%B8%20%E1%84%83%E1%85%A6%E1%84%86%E1%85%A9%20%E1%84%89%E1%85%B5%E1%84%8B%E1%85%A7%E1%86%AB%20eccc839767ab45fe83fc8cf3dd844c66/Untitled%2011.png)

이렇게 되면, 임계치(CPU 사용률 70% 이상)가 되었을 때 서버를 늘리는 행동을 할 것입니다.

이후에는 서버를 줄이는 정책(예를 들어 CPU 사용률 30% 이하일 시 서버 줄이기)을 설정하면, 그에 맞추어서 서버를 유동적으로 조절할 것입니다.